#include<stdio.h>
#include<math.h>
int main()
{
	double du = 0;
	double fen = 0;
	double miao = 0;
	double d = 0;
	double d0 = 0;
	double d1 = 0;
	double d2 = 0;
	double d3 = 0;
	double d4 = 0;
	double d5 = 0;
	double sum = 0;
	int i = 1;
	int n = 5;
	int j = 1;
	double s1 = 0;
	double s2 = 0;
	double s3 = 0;
	double s4 = 0;
	double s5 = 0;
	double x0 = 0;
	double y0 = 0;
	printf("请输入方位角\n");
	scanf("%lf %lf %lf", &du, &fen, &miao);
	double a = du;
	double b = fen / 60;
	double c = miao / 3600;
	d0 = a + b + c;
	printf("方位角d0=%lf\n", d0);
	for (i = 1; i <= 5; i++)
	{
		printf("请输入度、分、秒\n");
		scanf("%lf %lf %lf", &du, &fen, &miao);
		double a = du;
		double b = fen / 60;
		double c = miao / 3600;
		d = a + b + c;
		if (i == 1)
		{
			double d1 = d;
			printf("d1=%lf\n", d1);
		}
		if (i == 2)
		{
			double d2 = d;
			printf("d2=%lf\n", d2);
		}
		if (i == 3)
		{
			double d3 = d;
			printf("d3=%lf\n", d3);
		}
		if (i == 4)
		{
			double d4 = d;
			printf("d4=%lf\n", d4);
		}
		if (i == 5)
		{
			double d5 = d;
			printf("d5=%lf\n", d5);
		}
		sum += d;
	}
	printf("sum=%lf\n", sum);
	double sum0 = (n- 2) * 180;
	double f = sum - sum0;//闭合差=实测值-理论值
	f = f * 3600;//单位是秒
	double f0= f / n;//闭合差调整
	printf("f=%lf\n", f);

	double d1_ = d1 + f0;//闭合差分配
	double d2_ = d2 + f0;
	double d3_ = d3 + f0;
	double d4_ = d4 + f0;
	double d5_ = d5 + f0;

	double fd1 = d0 + d1_;//求方位角
	if (fd1 > 180)
	{
		fd1 = fd1 - 180;
		fd1 = fd1 / 180 * 3.14;
	}
	else
	{
		fd1 = fd1 + 180;
		fd1 = fd1 / 180 * 3.14;
	}
	double fd2 = fd1 + d2_;
	if (fd2 > 180)
	{
		fd2 = fd2 - 180;
		fd2 = fd2 / 180 * 3.14;
	}
	else
	{
		fd2 = fd2 + 180;
		fd2 = fd2 / 180 * 3.14;
	}
	double fd3 = fd2 + d3_;
	if (fd3 > 180)
	{
		fd3 = fd3 - 180;
		fd3 = fd3 / 180 * 3.14;
	}
	else
	{
		fd3 = fd3 + 180;
		fd3 = fd3 / 180 * 3.14;
	}
	double fd4 = fd3 + d4_;
	if (fd4 > 180)
	{
		fd4 = fd4 - 180;
		fd4 = fd4 / 180 * 3.14;
	}
	else
	{
		fd4 = fd4 + 180;
		fd4 = fd4 / 180 * 3.14;
	}
	double fd5 = fd4 + d5_;
	if (fd5 > 180)
	{
		fd5 = fd5 - 180;
		fd5 = fd5 / 180 * 3.14;
	}
	else
	{
		fd5 = fd5 + 180;
		fd5 = fd5 / 180 * 3.14;
	}

	printf("请输入距离：\n");
	scanf("%lf %lf %lf %lf %lf", &s1, &s2, &s3, &s4, &s5);

	double x1 = s1 * cos(fd1);//坐标闭合差与调差
	double y1 = s1 * sin(fd1);
	double x2 = s2 * cos(fd2);
	double y2 = s2 * sin(fd2);
	double x3 = s3 * cos(fd3);
	double y3 = s3 * sin(fd3);
	double x4 = s4 * cos(fd4);
	double y4 = s4 * sin(fd4);
	double x5 = s5 * cos(fd5);
	double y5 = s5 * sin(fd5);
	double x = x1 + x2 + x3 + x4 + x5;
	double y = y1 + y2 + y3 + y4 + y5;

	double s = s1 + s2 + s3 + s4 + s5;//按边长分配
	double v_x1 = -(x / s * s1);
	double v_y1 = -(y / s * s1);
	double v_x2 = -(x / s * s2);
	double v_y2 = -(x / s * s2);
	double v_x3 = -(x / s * s3);
	double v_y3 = -(x / s * s3);
	double v_x4 = -(x / s * s4);
	double v_y4 = -(x / s * s4);
	double v_x5 = -(x / s * s5);
	double v_y5 = -(x / s * s5);
	
	double X1_1= x1 + v_x1;//改正后的值
	double Y1_1= y1 + v_y1;
	double X2_2= x2 + v_x2;
	double Y2_2= y2 + v_y2;
	double X3_3= x3 + v_x3;
	double Y3_3= y3 + v_y3;
	double X4_4= x4 + v_x4;
	double Y4_4= y4 + v_y4;
	double X5_5= x5 + v_x5;
	double Y5_5= y5 + v_y5;

	printf("请输入已知坐标：\n");
	scanf("%lf %lf", &x0, &y0);

	double X1 = x0 + X1_1;
	double Y1 = y0 + Y1_1;
	printf("第一个点的坐标为：%lf %lf\n", X1, Y1);

	double X2 = x0 + X2_2;
	double Y2 = y0 + Y2_2;
	printf("第二个点的坐标为：%lf %lf\n", X2, Y2);

	double X3 = x0 + X3_3;
	double Y3 = y0 + Y3_3;
	printf("第三个点的坐标为：%lf %lf\n", X3, Y3);

	double X4 = x0 + X4_4;
	double Y4 = y0 + Y4_4;
    printf("第四个点的坐标为：%lf %lf\n", X4, Y4);

	double X5 = x0 + X5_5;
	double Y5 = y0 + Y5_5;
	printf("第五个点的坐标为：%lf %lf\n", X5, Y5);

	return 0;
}


